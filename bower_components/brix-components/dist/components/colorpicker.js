!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery"),require("components/base"),require("brix/event"),require("underscore")):"function"==typeof define&&define.amd?define(["jquery","components/base","brix/event","underscore"],e):"object"==typeof exports?exports["components/colorpicker"]=e(require("jquery"),require("components/base"),require("brix/event"),require("underscore")):t["components/colorpicker"]=e(t.jquery,t["components/base"],t["brix/event"],t.underscore)}(this,function(t,e,o,i){return function(t){function e(i){if(o[i])return o[i].exports;var s=o[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){var i,s;i=[o(3),o(7),o(4),o(5),o(6),o(2),o(8),o(9),o(10),o(9)],s=function(t,e,o,i,s,r,n,a,c,l){function d(){}function h(t,e,o){var i,s,r,n,a;t=t%360/60,a=o*e,n=a*(1-Math.abs(t%2-1)),i=s=r=o-a,t=~~t,i+=[a,n,0,0,n,a][t],s+=[n,a,a,n,0,0][t],r+=[0,0,n,a,a,n][t];var c=255*i,l=255*s,d=255*r;return{r:c,g:l,b:d,hex:"#"+(16777216|d|l<<8|c<<16).toString(16).slice(1)}}function p(t,e,o){(t>1||e>1||o>1)&&(t/=255,e/=255,o/=255);var i,s,r,n;return r=Math.max(t,e,o),n=r-Math.min(t,e,o),i=0===n?null:r==t?(e-o)/n+(e<o?6:0):r==e?(o-t)/n+2:(t-e)/n+4,i=i%6*60,s=0===n?0:n/r,{h:i,s:s,v:r}}var f=".colorpicker",u=["#d81e06","#f4ea2a","#1afa29","#1296db","#13227a","#d4237a","#ffffff","#e6e6e6","#dbdbdb","#cdcdcd","#bfbfbf","#8a8a8a","#707070","#515151","#2c2c2c","#000000","#ea986c","#eeb174","#f3ca7e","#f9f28b","#c8db8c","#aad08f","#87c38f","#83c6c2","#7dc5eb","#87a7d6","#8992c8","#a686ba","#bd8cbb","#be8dbd","#e89abe","#e8989a","#e16632","#e98f36","#efb336","#f6ef37","#afcd51","#7cba59","#36ab60","#1baba8","#17ace3","#3f81c1","#4f68b0","#594d9c","#82529d","#a4579d","#db649b","#dd6572","#d81e06","#e0620d","#ea9518","#f4ea2a","#8cbb1a","#2ba515","#0e932e","#0c9890","#1295db","#0061b2","#0061b0","#004198","#122179","#88147f","#d3227b","#d6204b"],v=/^input|textarea$/i;return d.SHORTCUTS=u,e.extend(d.prototype,o.prototype,{options:{placement:"bottom",align:"left",offset:{},color:"#ffffff",shortcuts:u,min:!1},init:function(){this.$element=t(this.element),this.data={color:this.options.color}},render:function(){var o=this,s=this.$relatedElement=t(e.template(r)(this.options)).insertAfter(this.$element),d=this.$pickerNode=s.find(".picker");this.$pickerDragNode=s.find(".picker-indicator");var h=this.$slideNode=s.find(".slide");this.$slideDragNode=s.find(".slide-indicator");var p=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";switch(p){case"SVG":h.append(n),d.append(a);break;default:document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),h.html(c),d.html(l)}this.hex(this.data.color);var f="click.colorpicker_toggle_"+this.clientId;this.$element.off(f).on(f,function(t){o.toggle(t)});var u=this.$manager=new i("bx-");u.delegate(this.$element,this),u.delegate(this.$relatedElement,this),this.$relatedElement.find("input").on("change",function(t){t.preventDefault(),t.stopPropagation()}),this._autoHide()},show:function(){this.$element.addClass("colorpicker-open"),this.$relatedElement.show().offset(this._offset())},hide:function(){this.$element.removeClass("colorpicker-open"),this.$relatedElement.hide()},toggle:function(){this.$element.toggleClass("colorpicker-open"),this.$relatedElement.toggle().offset(this._offset())},_offset:function(){var t=s(this.$element,this.$relatedElement,this.options.placement,this.options.align),e=parseInt(this.$relatedElement.css("margin-left"),10)||0,o=parseInt(this.$relatedElement.css("margin-top"),10)||0;return{left:t.left+e+(this.options.offset.left||0),top:t.top+o+(this.options.offset.top||0)}},_setColor:function(t){var e=this.$relatedElement;this.data.h=t.h%360,this.data.s=t.s,this.data.v=t.v;var o=h(this.data.h,this.data.s,this.data.v);this.$slideDragNode.css({top:Math.round(this.data.h*this.$slideNode.height()/360-5)});var i=Math.round(this.data.s*this.$pickerNode.width()-5),s=Math.round((1-this.data.v)*this.$pickerNode.height()-5);this.$pickerDragNode.css({left:i,top:s,color:s>98?"#fff":"#000"}),this.$pickerNode.css({"background-color":h(this.data.h,1,1).hex}),e.find(".colorpicker-footer span").css({"background-color":o.hex}),this.data.color=o.hex,e.find("li").removeClass("selected");var r=e.find("input");r.val()!==o.hex&&r.val(o.hex)},hsv:function(t){return t?(this._setColor(t),this):this._extra().hsv},rgb:function(t){return t?(this._setColor(p(t.r,t.g,t.b),t),this):this._extra().rgb},hex:function(t){return t?(this._setColor(p(parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)),void 0,t),this):this._extra().hex},_pickQuickColor:function(e,o){this.hex(o),t(e.target).addClass("selected")},_toggleBody:function(){this.$relatedElement.find(".colorpicker-middle").toggleClass("open"),this.$relatedElement.find(".colorpicker-body").slideToggle()},_pickPaletteColor:function(t){var e=this.$pickerNode.offset(),o=t.pageX-e.left,i=t.pageY-e.top,s=this.$pickerNode.width(),r=this.$pickerNode.height();this.hsv({h:this.data.h,s:o/s,v:(r-i)/r})},_dragPickerIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.pickerDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.$pickerNode.offset(),i=o.$pickerNode.width(),s=o.$pickerNode.height(),r=t.pageX-e.left,n=t.pageY-e.top;r+5>i?r=i:r<0?r=0:r+=5,n+5>s?n=s:n<0?n=0:n+=5,o.hsv({h:o.h,s:r/i,v:(s-n)/s})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.pickerDragNode")})},pickSlideColor:function(t){var e=this.$slideNode.offset(),o=this.$slideNode.height(),i=t.pageY-e.top>=o?o-1:t.pageY-e.top,s=i/o*360;this.hsv({h:s,s:this.data.s,v:this.data.v})},_dragSlideIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.slideDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.$slideNode.offset(),i=o.$slideNode.height(),s=t.pageY-e.top;s+5>i?s=i-1:s<0?s=0:s+=5,o.hsv({h:s/o.$slideNode.height()*360,s:o.s,v:o.v})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.slideDragNode")})},_inputColor:function(e){var o=t(e.target).val();7===o.length&&this.data.color!==o&&this.hex(o)},_finishInputColor:function(e){var o=t(e.target).val();this.data.color!=o&&this.hex(o)},_extra:function(){var t=h(this.data.h,this.data.s,this.data.v);return{hex:t.hex,hsv:{h:this.data.h,s:this.data.s,v:this.data.v},rgb:{r:t.r,g:t.g,b:t.b}}},_submit:function(){var e=this._extra(),o=t.Event("change"+f);this.trigger(o,e),o.isDefaultPrevented()||(v.test(this.element.nodeName)&&this.$element.val(e.hex),this.$element.triggerHandler("change"),this.hide())},_autoHide:function(){var e=this,o="click.colorpicker_autohide_"+this.clientId;t(document.body).off(o).on(o,function(t){e.element!==t.target&&(e.$relatedElement.has(t.target).length||e.hide())})},destroy:function(){this.$manager.undelegate(this.$element,this),this.$manager.undelegate(this.$relatedElement,this),this.$element.off("click.colorpicker_toggle_"+this.clientId),t(document.body).off("click.colorpicker_autohide_"+this.clientId),this.$relatedElement.remove()}}),d.hsv2rgb=h,d.rgb2hsv=p,d}.apply(e,i),!(void 0!==s&&(t.exports=s))},function(t,e,o){var i;i=function(){return'<div class="colorpicker <%= placement %>"">\n    <div class="colorpicker-header clearfix">\n        <ul class="clearfix">\n            <% for(var i = 0; i < shortcuts.length; i++) { %>\n            <li value="<%=shortcuts[i]%>" style="background-color:<%=shortcuts[i]%>;" bx-click="_pickQuickColor(<%=shortcuts[i]%>)"></li>\n            <% } %>\n        </ul>\n    </div>\n    <div class="colorpicker-middle clearfix <%= min ? \'\' : \'open\'%>">\n        <i bx-click="_toggleBody" class="uxicon arrow arrow-up">&#404</i>\n        <i bx-click="_toggleBody" class="uxicon arrow arrow-down">&#405</i>\n    </div>\n    <div class="colorpicker-body clearfix <%= min ? \'\' : \'open\'%>">\n        <div class="picker-wrapper">\n            <div class="picker" bx-click="_pickPaletteColor()"></div>\n            <i class="uxicon picker-indicator" bx-mousedown="_dragPickerIndicator()">&#470</i>\n        </div>\n        <div class="slide-wrapper">\n            <div class="slide" bx-click="pickSlideColor()"></div>\n            <i class="uxicon slide-indicator" bx-mousedown="_dragSlideIndicator">&#461</i>\n        </div>\n    </div>\n    <div class="colorpicker-footer clearfix">\n        <span class="bg" style="background-color: <%=color%>"></span>\n        <input type="text" class="form-control" value="<%=color%>" bx-keyup="_inputColor" bx-blur="_finishInputColor">\n        <a class="btn btn-default" bx-click="_submit">确定</a>\n    </div>\n</div>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))},function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e){t.exports=o},function(t,e,o){var i,s;i=[o(3)],s=function(t){function e(e,i,s,a){var c=t(e);if(!c.length)return o(i);var l=c.offset(),d=l.left,h=l.top,p=c.outerWidth(),f=c.outerHeight(),u=t(i),v="none"!==u.css("display");u.show();var g=u.outerWidth(),m=u.outerHeight();v||u.hide();var b,x,k=p/2-g/2,y=f/2-m/2;switch(s){case"top":b=d+k,x=h-m;break;case"bottom":b=d+k,x=h+f;break;case"left":b=d-g,x=h+y;break;case"right":b=d+p,x=h+y}if(r.test(s)!==r.test(a)&&n.test(s)!==n.test(a))switch(a){case"top":x=h;break;case"bottom":x=h+f-m;break;case"left":b=d;break;case"right":b=d+p-g}return{left:b,top:x}}function o(e,o){var i,s;if(o)i=parseFloat(e,12),s=parseFloat(o,12);else{var r=t(e),n="none"!==r.css("display");r.show(),i=r.outerWidth(),s=r.outerHeight(),n||r.hide()}var a=t(window),c=a.width(),l=a.height(),d=a.scrollLeft(),h=a.scrollTop();return{left:c/2-i/2+d,top:l/2-s/2+h}}function i(e,o,i){var s=t(e),r="none"!==s.css("display");s.show();var n=s.outerWidth(),a=s.outerHeight();r||s.hide();var c={opacity:0,left:o.left,top:o.top};switch(i){case"top":c.top=c.top-.5*a;break;case"bottom":c.top=c.top+.5*a;break;case"left":c.left=c.left-.5*n;break;case"right":default:c.left=c.left+.5*n}return c}function s(t,e){return{opacity:1,left:e.left,top:e.top}}var r=/top|bottom/,n=/left|right/;return e.center=o,e.start=i,e.end=s,e}.apply(e,i),!(void 0!==s&&(t.exports=s))},function(t,e){t.exports=i},function(t,e,o){var i;i=function(){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\n    <defs>\n        <linearGradient id="gradient-hsv" x1="0%" y1="100%" x2="0%" y2="0%">\n            <stop offset="0%" stop-color="#FF0000" stop-opacity="1"></stop>\n            <stop offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop>\n            <stop offset="25%" stop-color="#8000FF" stop-opacity="1"></stop>\n            <stop offset="38%" stop-color="#0040FF" stop-opacity="1"></stop>\n            <stop offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop>\n            <stop offset="63%" stop-color="#00FF40" stop-opacity="1"></stop>\n            <stop offset="75%" stop-color="#0BED00" stop-opacity="1"></stop>\n            <stop offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop>\n            <stop offset="100%" stop-color="#FF0000" stop-opacity="1"></stop>\n        </linearGradient>\n    </defs>\n    <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-hsv)"></rect>\n</svg>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,o){var i;i=function(){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\n    <defs>\n        <lineargradient id="gradient-black" x1="0%" y1="100%" x2="0%" y2="0%">\n            <stop offset="0%" stop-color="#000000" stop-opacity="1"></stop>\n            <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\n        </lineargradient>\n        <lineargradient id="gradient-white" x1="0%" y1="100%" x2="100%" y2="100%">\n            <stop offset="0%" stop-color="#FFFFFF" stop-opacity="1"></stop>\n            <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\n        </lineargradient>\n    </defs>\n    <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-white)"></rect>\n    <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-black)"></rect>\n</svg>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,o){var i;i=function(){return'<div style="position: relative; width: 100%; height: 100%">\n    <v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">\n        <v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>\n    </v:rect>\n</div>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))}])});
//# sourceMappingURL=colorpicker.js.map
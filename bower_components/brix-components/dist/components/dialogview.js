!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("underscore"),require("brix/base"),require("magix"),require("jquery"),require("components/base"),require("brix/event")):"function"==typeof define&&define.amd?define(["underscore","brix/base","magix","jquery","components/base","brix/event"],e):"object"==typeof exports?exports["components/dialogview"]=e(require("underscore"),require("brix/base"),require("magix"),require("jquery"),require("components/base"),require("brix/event")):t["components/dialogview"]=e(t.underscore,t["brix/base"],t.magix,t.jquery,t["components/base"],t["brix/event"])}(this,function(t,e,o,i,n,s){return function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){var i,n;i=[o(2),o(3),o(4),o(5)],n=function(t,e,o,i){function n(){arguments.length>1&&(this.options=t.extend({},this.options,arguments[0]),this.options["view-name"]=arguments[1],this.options["view-options"]=arguments[2],this.init(),this.render())}var s="vf-dialog",r='<div class="dialog-body"><div id="'+s+'" mx-vframe="true"></div></div>';t.extend(n.prototype,e.prototype,{options:{},init:function(){this.options.content||(this.options.content=r),this.options.view||(this.options.view={name:this.options["view-name"],options:this.options["view-options"]}),this.dialog&&this.dialog.destroy(),this.dialog=new i(this.options)},render:function(){},fill:function(){if(this.options.hostView)return void this.options.hostView.owner.mountVframe(s,this.options.view.name,this.options.view.options);var t=o.VOM.get(s)||new o.Vframe(s);t.unmountVframe(s),t.mountVframe(s,this.options.view.name,this.options.view.options)},open:function(){this.dialog.open(),this.fill()},close:function(){this.dialog.close();var t=o.VOM.get(s);t&&t.unmountVframe(s)},destroy:function(){this.close(),this.dialog.destroy()}});var l={open:function(t,e,o){this.dialog&&this.dialog.destroy(),this.dialog=new n(t,e,o),this.dialog.open(),t.hostView&&t.hostView.manage(this.dialog)},close:function(){this.dialog&&this.dialog.destroy()}};return l}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e){t.exports=o},function(t,e,o){var i,n;i=[o(6),o(2),o(7),o(8),o(9),o(10)],n=function(t,e,o,i,n,s){function r(){arguments.length&&(this.options=e.extend({},this.options,arguments[0]),this.init(),this.render()),c.push(this)}var l=150,a="swing",d=".dialog",h=[],c=[],p={PENDING:"pending",OPENED:"opened",CLOSED:"closed"};return e.extend(r.prototype,o.prototype,{options:{placement:"right",align:"top",left:void 0,top:void 0,width:"auto",height:"auto",offset:{left:0,top:0},className:"",content:"",closable:!0,movable:!1,modal:!1,singleton:!0},state:p.PENDING,init:function(){this.$element=t(this.element||this.options.element),this.$manager=new i("bx-"),this.options.css&&e.isString(this.options.css)&&window.require(["css!"+this.options.css]),this.options["class"]&&(this.options.className=this.options["class"]),(""+this.options.content).indexOf("<")===-1&&(this.options.content='<div class="dialog-body">'+this.options.content+"<div>")},render:function(){this.fill(),this.$manager.delegate(this.$element,this)},destroy:function(){this.close(),c=e.without(c,this);var o="keyup.dialog_autohide_"+this.clientId;h.length||t(document.body).off(o),this.$manager.undelegate(this.$element),this.$manager.undelegate(this.$relatedElement),this.$relatedElement.remove(),this.$relatedElement=null,this.$backdropElement=null},fill:function(){var o=e.template(s)(this.options);return this.$relatedElement||(this.$relatedElement=t(o).appendTo(document.body).hide()),this.options.singleton||this.$relatedElement.removeClass("dialog-singleton"),this.$relatedElement.find(".dialog-content").html(this.options.content),this.$relatedElement.css({width:this.options.width,height:this.options.height}),this.$backdropElement=t(".dialog-backdrop"),this.$backdropElement.length||(this.$backdropElement=t('<div class="dialog-backdrop"></div>').hide().appendTo(document.body)),this.options.modal,this.options.className&&this.$relatedElement.addClass(this.options.className),this.options.css&&e.isObject(this.options.css)&&this.$relatedElement.css(this.options.css),this.$manager.delegate(this.$relatedElement,this),this},open:function(){!this.element&&this.options.element&&this.options.element!==this.$element[0]&&(this.$element=t(this.options.element)),this.options.singleton&&e.each(h,function(t){t.options.singleton&&t.close()}),this.fill(),this._zIndex("open"),this._topmost(),this._move(),this.options.modal&&(t(document.body).addClass("modal-open"),this.$backdropElement.show().css("z-index",+this.$relatedElement.css("z-index")-1));var o=this._offset();return this.$relatedElement.show().stop().css(n.start(this.$relatedElement,o)).animate(n.end(this.$relatedElement,o),l,a),this._autoHide(),h.push(this),this.trigger("open"+d),this.state=p.OPENED,this},close:function(){if(!this.$relatedElement||!this.$relatedElement.length)return this;if(this.state===p.CLOSED)return this;var o=t.Event("close"+d);if(this.trigger(o),!o.isDefaultPrevented()){var i=this,s=this._offset();if(this.$relatedElement.stop().animate(n.start(this.$relatedElement,s),l,a,function(){i.$relatedElement&&i.$relatedElement.hide()}),h=e.without(h,this),this.options.modal){var r=e.filter(h,function(t){if(t.options.modal)return t}).length;r||(t(document.body).removeClass("modal-open"),this.$backdropElement.hide())}return this._zIndex("close"),this.state=p.CLOSED,this}},_offset:function(){var t=void 0!==this.options.left&&void 0!==this.options.top?{left:this.options.left,top:this.options.top}:n(this.$element,this.$relatedElement,this.options.placement,this.options.align);return t={left:t.left+(this.options.offset.left||0),top:t.top+(this.options.offset.top||0)}},_autoHide:function(){var e="keyup.dialog_autohide_"+this.clientId;return t(document.body).off(e).on(e,function(t){if(27===t.keyCode){var e=h[h.length-1];e&&e.options.closable&&e.close()}}),this},_zIndex:function(t){if(h.length){var o,i=e.max(h,function(t){return+t.$relatedElement.css("z-index")}),n=+i.$relatedElement.css("z-index");switch(t){case"open":if(o=this,o===i)return;break;case"close":o=h[h.length-1]}return o.$backdropElement&&o.$backdropElement.css("z-index",n+1),o.$relatedElement.css("z-index",n+2),this}},_topmost:function(){var t=this,e="mousedown.dialog_topmost_"+this.clientId;return this.$relatedElement.off(e).on(e,function(){t._zIndex("open"),h.push(t)}),this},_move:function(){if(!this.options.movable)return this;var e=this,o="mousedown.dialog_move_"+this.clientId,i="mousemove.dialog_move_"+this.clientId,n="mouseup.dialog_move_"+this.clientId,s=t(document.body),r=this.$relatedElement.find(".dialog-header");return r.addClass("cursor-move"),r.off(o).on(o,function(t){var o=r.offset(),l={left:t.pageX-o.left,top:t.pageY-o.top};s.on(i,function(t){return e.$relatedElement.offset({left:t.pageX-l.left,top:t.pageY-l.top}),!1}),s.on(n,function(){return s.off(i),s.off(n),!1})}),this}}),r.open=function(t){return new r(t).open()},r.close=function(){var t=h.pop();t&&t.close()},r.closeAll=function(){return e.each(h,function(t){t.close()}),this},r.destroy=function(){return e.each(c,function(t){t.destroy()}),this},r}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(t,e){t.exports=i},function(t,e){t.exports=n},function(t,e){t.exports=s},function(t,e,o){var i,n;i=[o(6)],n=function(t){function e(e,i,n,l){var a=t(e);if(!a.length)return o(i);var d=a.offset(),h=d.left,c=d.top,p=a.outerWidth(),u=a.outerHeight(),f=t(i),m="none"!==f.css("display");f.show();var g=f.outerWidth(),v=f.outerHeight();m||f.hide();var b,x,$=p/2-g/2,y=u/2-v/2;switch(n){case"top":b=h+$,x=c-v;break;case"bottom":b=h+$,x=c+u;break;case"left":b=h-g,x=c+y;break;case"right":b=h+p,x=c+y}if(s.test(n)!==s.test(l)&&r.test(n)!==r.test(l))switch(l){case"top":x=c;break;case"bottom":x=c+u-v;break;case"left":b=h;break;case"right":b=h+p-g}return{left:b,top:x}}function o(e,o){var i,n;if(o)i=parseFloat(e,12),n=parseFloat(o,12);else{var s=t(e),r="none"!==s.css("display");s.show(),i=s.outerWidth(),n=s.outerHeight(),r||s.hide()}var l=t(window),a=l.width(),d=l.height(),h=l.scrollLeft(),c=l.scrollTop();return{left:a/2-i/2+h,top:d/2-n/2+c}}function i(e,o,i){var n=t(e),s="none"!==n.css("display");n.show();var r=n.outerWidth(),l=n.outerHeight();s||n.hide();var a={opacity:0,left:o.left,top:o.top};switch(i){case"top":a.top=a.top-.5*l;break;case"bottom":a.top=a.top+.5*l;break;case"left":a.left=a.left-.5*r;break;case"right":default:a.left=a.left+.5*r}return a}function n(t,e){return{opacity:1,left:e.left,top:e.top}}var s=/top|bottom/,r=/left|right/;return e.center=o,e.start=i,e.end=n,e}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(t,e,o){var i;i=function(){return'<div class="dialog dialog-singleton dialog-<%= placement %>">\n    <button bx-click="close" type="button" class="dialog-close <%= closable ? \'\' : \'hide\' %>"><span class="brixfont">&#xe62d;</span><!-- &times; --></button>\n    <div class="dialog-content">\n        <%= content %>\n        <!-- \n        <div class="dialog-header">\n            <h4 class="dialog-title">Title</h4>\n        </div>\n        <div class="dialog-body">Body</div>\n        <div class="dialog-footer">\n            <button bx-click="close" type="button" class="btn btn-default">Close</button>\n            <button bx-click="close" type="button" class="btn btn-primary">Save</button>\n        </div>\n         -->\n    </div>\n</div>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))}])});
//# sourceMappingURL=dialogview.js.map
define(["underscore","brix/base","magix","../dialog/dialog.js"],function(i,o,t,n){function s(){arguments.length>1&&(this.options=i.extend({},this.options,arguments[0]),this.options["view-name"]=arguments[1],this.options["view-options"]=arguments[2],this.init(),this.render())}var e="vf-dialog",a='<div class="dialog-body"><div id="'+e+'" mx-vframe="true"></div></div>';i.extend(s.prototype,o.prototype,{options:{},init:function(){this.options.content||(this.options.content=a),this.options.view||(this.options.view={name:this.options["view-name"],options:this.options["view-options"]}),this.dialog&&this.dialog.destroy(),this.dialog=new n(this.options)},render:function(){},fill:function(){if(this.options.hostView)return void this.options.hostView.owner.mountVframe(e,this.options.view.name,this.options.view.options);var i=t.VOM.get(e)||new t.Vframe(e);i.unmountVframe(e),i.mountVframe(e,this.options.view.name,this.options.view.options)},open:function(){this.dialog.open(),this.fill()},close:function(){this.dialog.close();var i=t.VOM.get(e);i&&i.unmountVframe(e)},destroy:function(){this.close(),this.dialog.destroy()}});var h={open:function(i,o,t){this.dialog&&this.dialog.destroy(),this.dialog=new s(i,o,t),this.dialog.open(),i.hostView&&i.hostView.manage(this.dialog)},close:function(){this.dialog&&this.dialog.destroy()}};return h});
define(["jquery","underscore","handlebars","components/base","./errortips.tpl.js","css!./errortips.css"],function(t,s,i,e,o){function r(){arguments.length&&(this.element=t(arguments[0]),this.options=s.extend(this.options,arguments[1]))}return s.extend(r.prototype,e.prototype,{options:{width:180,msg:"操作<span>不正确</span>，请重新操作",duration:2e3,shake:!0},render:function(){},destroy:function(){this._tips&&this._tips.remove()},showTips:function(s){var i=t(this.element);i.hasClass("btn-error")||(t(".btn-error-tips[data-btn-error]").length&&(clearTimeout(this.itv),t(".btn-error-tips[data-btn-error]").remove()),this.options.shake&&this._shake(),this._showTips(s))},_showTips:function(s){var e=this,r=t(this.element),n=this.options.width,h=this.options.duration,p=30;s=s||this.options.msg,e.fadeOut&&e.fadeOut.stop(),this.itv=setTimeout(function(){e.fadeOut=e._tips.fadeOut(250,"swing",function(){e._tips.remove(),e.trigger("complete.errortips",e)})},h);var a=r.offset(),d=o,u=r.outerWidth()/2-10,f=i.compile(d)({width:n,msg:s,left:u+p});this._tips=t(f),t("body").append(this._tips);var c=a.left-p,l=a.top-this._tips.outerHeight()-20,m=t(window).width(),_=c+this._tips.outerWidth()-m;_>0&&(c-=_,this._tips.find(".arrow").css({left:u+p+_})),0>c&&(this._tips.find(".arrow").css({left:u+p+c}),c=0),this._tips.css({left:c,top:l+25,opacity:0}),this._tips.animate({left:c,top:l,opacity:1},250,"swing")},_shake:function(){var s=t(this.element),i=s.width(),e=s.html();s.addClass("btn-error"),s.width(i),s.html('<i class="errortips-icon">&#xe600;</i>'),setTimeout(function(){s.html(e),s.removeClass("btn-error")},1e3)}}),r});
define(["jquery","underscore","brix/base","brix/event","./modal.tpl.js"],function(e,t,n,i,d){var o=150;return n.extend({options:{title:Math.random(),body:Math.random()},init:function(){this.$element=e(this.element)},render:function(){var n=this,o=new i("bx-"),a=t.template(d)(this.options);this.$relatedElement=e(a).insertAfter(this.$element),this.$dialog=this.$relatedElement.find(".modal-dialog"),this.$backdropElement=e(".modal-backdrop"),this.$backdropElement.length||(this.$backdropElement=e('<div class="modal-backdrop fade"></div>').hide().appendTo(document.body)),o.delegate(this.$element,this),o.delegate(this.$relatedElement,this),this.$element.on("click",function(){n.show()});var l="keyup.modal_"+this.clientId;e(document.body).off(l).on(l,function(e){27===e.which&&n.hide()})},show:function(){e(document.body).addClass("modal-open");var t=this;this.$relatedElement.show(),this.$backdropElement.show(),setTimeout(function(){t.$relatedElement.addClass("in"),t.$backdropElement.addClass("in")},o)},hide:function(){e(document.body).removeClass("modal-open");var t=this;this.$relatedElement.removeClass("in"),this.$backdropElement.removeClass("in"),setTimeout(function(){t.$relatedElement.hide(),t.$backdropElement.hide()},o)}})});
define("brix/event/constant",[],function(){return{PREFIX:"bx-",BX_EVENT_NAMESPACE:"."+(Math.random()+"").replace(/\D/g,""),RE_FN_ARGS:/([^()]+)(?:\((.*)\))?/,RE_TARGET_TYPE:/^(window|document|body)-(.+)/,BX_EVENT_SEPARATION:"bx-event-separation-",BX_EVENT_CACHE:"bx-event-cache-"}}),define("brix/event/debug",[],function(){return~location.search.indexOf("brix.event.debug")&&{fix:function(e,t){for(var r=parseInt(t,10)-(""+e).length,n=0;r>n;n++)e+=" ";return e}}}),define("brix/event/parser",["jquery","underscore","./constant"],function(jQuery,_,Constant){function parseBxEvents(e,t){var r=new RegExp(e+"(?!name|options)(.+)"),n=[];if(!t.nodeType&&t.length)return _.each(t,function(t){n=n.concat(parseBxEvents(e,t))}),n;var a=function(){var e=[t];if(t.getElementsByTagName)for(var r=t.getElementsByTagName("*"),n=0;n<r.length;n++)e.push(r[n]);return e}();return _.each(a,function(e){_.each(e.attributes,function(t){r.exec("");var a=r.exec(t.name);if(a){var o={target:e,type:a[1],handler:t.value};_.extend(o,parseMethodAndParams(t.value)),n.push(o),e._bx_events||(e._bx_events={}),e._bx_events[o.type]=!0}})}),n}function parseBxTypes(e,t){return _.unique(_.map(parseBxEvents(e,t),function(e){return e.type})).sort()}function parseMethodAndParams(handler){if(handler){var parts=Constant.RE_FN_ARGS.exec(handler),method,params;if(parts&&parts[1]){method=parts[1],params=jQuery.trim(parts[2]||"");try{params=eval("["+params+"]")}catch(error){params=params.split(/\s*,\s*/)}return{method:method,params:params}}}}return{parseBxEvents:parseBxEvents,parseBxTypes:parseBxTypes,parseMethodAndParams:parseMethodAndParams}}),define("brix/event/handle",["jquery","./parser"],function(jQuery,Parser){function entrees(event,owner,prefix,type){var extraParameters=[].slice.call(arguments,4),currentTarget=jQuery(event.currentTarget),handler=currentTarget.attr(prefix+type)||currentTarget.attr(prefix+event.type+"."+event.namespace)||currentTarget.attr(prefix+event.type);if(handler){var parts=Parser.parseMethodAndParams(handler);if(parts&&owner[parts.method]){var namespace=event.namespace,originalNamespace=event.originalNamespace;originalNamespace&&(event.namespace=originalNamespace);try{owner[parts.method].apply(owner,[event].concat(extraParameters).concat(parts.params))}finally{originalNamespace&&(event.namespace=namespace)}}else eval(handler)}}return entrees}),define("brix/event/target/delegate",["jquery","underscore","../constant","../parser"],function(jQuery,_,Constant,Parser){function delegate(prefix,type,element,owner){function _bxTargetTypeAppetizer(e){var t=e.type;e.type=bxtype,jQuery(e.target).trigger(e,[].slice.call(arguments,1)),e.type=t}function _bxTargetTypeEntrees(event){var selector="["+prefix+type+"]",$targets=function(){var e=[];jQuery(event.target).is(selector)&&e.push(event.target);var t=jQuery(event.target).parentsUntil(element,selector);return e=e.concat(t.toArray()),jQuery(e)}(),currentType=event.type,originalType=ma[2];event.type=originalType;var extraParameters=[].slice.call(arguments,2);_.each($targets,function(item){var handler=jQuery(item).attr(currentType);if(handler){var parts=Parser.parseMethodAndParams(handler);parts&&owner[parts.method]?owner[parts.method].apply(owner,[event].concat(extraParameters).concat(parts.params)):eval(handler)}}),event.type=currentType}Constant.RE_TARGET_TYPE.exec("");var ma=Constant.RE_TARGET_TYPE.exec(type);if(!ma)throw"不支持 "+type;var bxtype=prefix+type,$target="window"===ma[1]&&jQuery(window)||"document"===ma[1]&&jQuery(document)||"body"===ma[1]&&jQuery(document.body);$target.on(ma[2]+Constant.BX_EVENT_NAMESPACE,_bxTargetTypeAppetizer),$target.on(bxtype+Constant.BX_EVENT_NAMESPACE,_bxTargetTypeEntrees)}return delegate}),define("brix/event/target/undelegate",["jquery","../constant"],function(e,t){function r(r,n){t.RE_TARGET_TYPE.exec("");var a=t.RE_TARGET_TYPE.exec(n);if(!a)throw"不支持 "+n;var o=r+n,s="window"===a[1]&&e(window)||"document"===a[1]&&e(document)||"body"===a[1]&&e(document.body);s.off(a[2]+t.BX_EVENT_NAMESPACE),s.off(o+t.BX_EVENT_NAMESPACE)}return r}),define("brix/event/target/index",["./delegate","./undelegate"],function(e,t){return{delegate:e,undelegate:t}}),define("brix/event/delegate",["jquery","underscore","./constant","./debug","./parser","./handle","./target/index"],function(e,t,r,n,a,o,s){function p(p,c,u){var d=e(document.body),E=e(c),l=E.data();if(l){l[r.BX_EVENT_SEPARATION+p]=Math.random(),l[r.BX_EVENT_CACHE+p]||(l[r.BX_EVENT_CACHE+p]={});var _=a.parseBxTypes(p,c);t.each(_,function(t){function a(n){if(!e(n.target).closest(".disabled").length&&i(p,n.currentTarget)===l[r.BX_EVENT_SEPARATION+p]){var a=[].slice.call(arguments,1);n.owner||(n.owner=u),n.component||(n.component=function(){try{return require("brix/loader").query(n.currentTarget)[0]}catch(e){}}()),o.apply(this,[n,u,p,t].concat(a))}}var E=p+t,_=("["+E+"]").replace(/\./g,"\\.");if(!l[r.BX_EVENT_CACHE+p][E]){if(n&&console.log(n.fix(t,16),E),r.RE_TARGET_TYPE.exec(""),r.RE_TARGET_TYPE.exec(t))return s.delegate(p,t,c,u),void(l[r.BX_EVENT_CACHE+p][E]={type:t,bxtype:E});d.on(t+r.BX_EVENT_NAMESPACE,_,a),l[r.BX_EVENT_CACHE+p][E]={type:t,bxtype:E,namespace:r.BX_EVENT_NAMESPACE,selector:_,appetizer:a}}})}}function i(t,n){var a=e(n).data(r.BX_EVENT_SEPARATION+t);if(!a)for(var o=e(n).parents(),s=0;s<o.length;s++)if(o.eq(s).data(r.BX_EVENT_SEPARATION+t)){a=o.eq(s).data(r.BX_EVENT_SEPARATION+t);break}return a}return p}),define("brix/event/undelegate",["jquery","underscore","./constant","./target/index"],function(e,t,r,n){function a(a,o){var s=e(document.body),p=e(o),i=p.data();i&&(t.each(i[r.BX_EVENT_CACHE+a],function(e,t){return r.RE_TARGET_TYPE.exec(""),r.RE_TARGET_TYPE.exec(e.type)?void n.undelegate(a,e.type,o):void s.off(e.type+e.namespace,e.selector,e.appetizer)}),i[r.BX_EVENT_CACHE+a]={})}return a}),define("brix/event",["./event/constant","./event/debug","./event/parser","./event/delegate","./event/undelegate"],function(e,t,r,n,a){function o(t){return this instanceof o?void(this.prefix=t||e.PREFIX):new o(t)}return o.prototype.delegate=function(e,r){e=e||document.body,r=r||window;var o=this.prefix+"event";return t&&(console.group(o),console.time(o),console.log(e)),a(this.prefix,e),n(this.prefix,e,r),t&&(console.timeEnd(o),console.groupEnd(o)),this},o.prototype.undelegate=function(e){return e=e||document.body,a(this.prefix,e),this},o.NAMESPACE=e.BX_EVENT_NAMESPACE,o._delegate=n,o._undelegate=a,o._parseBxEvents=r.parseBxEvents,o._parseBxTypes=r.parseBxTypes,o._parseMethodAndParams=r.parseMethodAndParams,o});